
-- ====================== Œƒº˛–≈œ¢ ======================

-- Ω£œ¿«È‘µonline IB ∞Ê±æœﬁ÷∆Õ–π‹µƒÕ∑Œƒº˛
-- Edited by peres
-- 2006/10/30 PM 15:42

-- —Ãª®°£ƒ«“ª“πµƒ—Ãª®°£
-- À˝º«µ√À˚‘⁄¥Û”Íµƒ»À»∫÷–£¨’æ‘⁄À˝µƒ±≥∫Û”µ±ß◊°À˝°£
-- À˚Œ¬≈Øµƒ∆§∑Ù£¨À˚ Ïœ§µƒŒ∂µ¿°£—Ãª®’’¡¡À˝µƒ—€æ¶°£
-- “ª«–Œﬁø…ÕÏªÿ°≠°≠

-- ======================================================

NUM_OFFLINE_PERMITREGION_MAX = 10;  -- ¿Î≤ª‘ –ÌÕ–π‹µ„µƒ◊Ó–°∞Îæ∂

aryLimitRegion = {
	--„Íæ©
	[37]={
		{1630, 3187},--NPC ≥µ∑Ú	
		{1704, 3224},--NPC ≥µ∑Ú	
		{1595, 2994},--NPC ≥µ∑Ú	
		{1860, 2928},--NPC ≥µ∑Ú	
		{1755, 3043},--Œ‰¡÷¥´»À	
		{1806, 3098},--¿ÒπŸ	
		{1712, 3102},--Ã˙Ω≥	
		{1747, 3050},--Ã˙Ω≥	
		{1773, 3090},--“©µÍ	
		{1786, 3103},--‘”ªı∆Ã
		{1776, 3063},--Œ‰¡÷–¬–„¡™»¸πŸ‘±	
		{1740, 3065},-- ‘¡∂Ã√	
		{1646, 3050},--ƒÙ ø≥¬	
		{1589, 3096},--–°∑∑	
		{1784, 3042},--ƒ⁄∏Û…– È	
		{1641, 3145},--∆º∆ºπ√ƒÔ	
		{16620, 3019},--∆º∆ºπ√ƒÔ	
		{1713, 374},--∆º∆ºπ√ƒÔ	
		{1865, 2968},--∆º∆ºπ√ƒÔ	
		{1734, 3102},--“∞€≈	
		{1693, 3212},--π•≥«≥µ∑Ú	
	},

	--¥Û¿Ì
	[162]={
		{1669, 3124},--NPC ≥µ∑Ú	
		{1697, 3279},--NPC ≥µ∑Ú	
		{1469, 3269},--NPC ≥µ∑Ú	
		{1628, 3184},--Œ‰¡÷¥´»À	
		{1587, 3221},--¿ÒπŸ	
		{15599, 3262},--Ã˙Ω≥	
		{1449, 3211},--“©µÍ	
		{1535, 3201},--‘”ªı∆Ã
		{1651, 3226},--¡™»¸ π’ﬂ	
		{1613, 3190},-- ‘¡∂Ã√	
		{1574, 3227},--ƒÙ ø≥¬	
		{1671, 3236},--–°∑∑	
		{1651, 3226},--“∞€≈	
		{1681, 3276},--π•≥«≥µ∑Ú	
	},

	--œÂ—Ù
	[78] = {
		{1509, 3140},--NPC ≥µ∑Ú	
		{1439, 3212},--NPC ≥µ∑Ú	
		{1598, 3378},--NPC ≥µ∑Ú	
		{1693, 3233},--NPC ≥µ∑Ú	
		{1609, 3259},--Œ‰¡÷¥´»À	
		{1541, 3247},--¿ÒπŸ	
		{1550, 3217},--Ã˙Ω≥	
		{1612, 3244},--“©µÍ	
		{1628, 3262},--‘”ªı∆Ã
		{1546, 3118},--Œ‰¡÷–¬–„¡™»¸πŸ‘±	
		{1606, 3238},-- ‘¡∂Ã√	
		{1511, 3208},--ƒÙ ø≥¬	
		{1489, 3270},--–°∑∑	
		{1594, 3289},--“∞€≈	
		{1582, 3379},--π•≥«≥µ∑Ú	
		{1554, 3183},--…Ò√ÿ…Ã»À			
	},

	--≥…∂º
	[11]={
		{3196, 5194},--NPC ≥µ∑Ú	
		{3266, 5003},--NPC ≥µ∑Ú	
		{3027, 4960},--NPC ≥µ∑Ú	
		{3017, 5090},--NPC ≥µ∑Ú	
		{3135, 5045},--Œ‰¡÷¥´»À	
		{3126, 4994},--¿ÒπŸ	
		{3104, 5121},--Ã˙Ω≥	
		{3141, 5136},--“©µÍ	
		{3095, 5136},--‘”ªı∆Ã
		{3213, 5148},--¡™»¸ π’ﬂ	
		{3109, 5059},-- ‘¡∂Ã√	
		{3210, 4974},--ƒÙ ø≥¬	
		{3180, 4947},--–°∑∑	
		{3153, 5066},--“∞€≈	
		{3185, 5182},--π•≥«≥µ∑Ú	
	},
	
	--—Ô÷›
	[80]={
		{1717, 3198},--NPC ≥µ∑Ú	
		{1592, 3195},--NPC ≥µ∑Ú	
		{1670, 2991},--NPC ≥µ∑Ú	
		{1825, 3064},--NPC ≥µ∑Ú	
		{1792, 3047},--Œ‰¡÷¥´»À	
		{1745, 3000},--¿ÒπŸ	
		{1689, 3170},--Ã˙Ω≥	
		{1773, 3079},--“©µÍ	
		{1701, 3022},--‘”ªı∆Ã
		{1754, 3035},--¡™»¸ π’ﬂ	
		{1705, 3058},-- ‘¡∂Ã√	
		{1702, 2962},--ƒÙ ø≥¬	
		{1638, 3049},--–°∑∑	
		{1743, 2966},--“∞€≈	
		{1691, 3219},--π•≥«≥µ∑Ú	
	},
	
	--∑ÔœË
	[1]={
		{1647, 3166},--NPC ≥µ∑Ú	
		{1557, 3108},--NPC ≥µ∑Ú	
		{1520, 3230},--NPC ≥µ∑Ú	
		{1652, 3281},--NPC ≥µ∑Ú	
		{1623, 3205},--Œ‰¡÷¥´»À	
		{1614, 3152},--¿ÒπŸ	
		{1618, 3196},--Ã˙Ω≥	
		{1604, 3190},--“©µÍ	
		{1559, 3206},--‘”ªı∆Ã
		{1671, 3218},--¡™»¸ π’ﬂ	
		{1586, 3229},-- ‘¡∂Ã√	
		{1507, 3198},--ƒÙ ø≥¬	
		{1619, 3103},--–°∑∑	
		{1618, 3090},--“∞€≈	
		{1640, 3270},--π•≥«≥µ∑Ú	
	},
	
	--¡Ÿ∞≤
	[176]={
		{1606, 3292},--NPC ≥µ∑Ú	
		{1372, 3329},--NPC ≥µ∑Ú	
		{1601, 2912},--NPC ≥µ∑Ú	
		{1353, 3014},--NPC ≥µ∑Ú	
		{1532, 3010},--Œ‰¡÷¥´»À	
		{1506, 2984},--¿ÒπŸ	
		{1683, 3220},--Ã˙Ω≥	
		{1332, 3060},--Ã˙Ω≥	
		{1520, 2986},--Ã˙Ω≥	
		{1685, 3319},--“©µÍ	
		{1474, 3362},--“©µÍ	
		{1544, 2964},--“©µÍ	
		{1615, 2977},--“©µÍ	
		{1340, 3165},--‘”ªı∆Ã
		{1457, 3259},--Œ‰¡÷–¬–„¡™»¸πŸ‘±	
		{1592, 2944},-- ‘¡∂Ã√	
		{1371, 3007},--ƒÙ ø≥¬	
		{1387, 2961},--–°∑∑	
		{1561, 2980},--“∞€≈	
		{1689, 3291},--π•≥«≥µ∑Ú	
		{1654, 3263},--’∆µ∆π¨≈Æ	
		{1439, 3268},--’∆µ∆π¨≈Æ	
		{1384, 2979},--’∆µ∆π¨≈Æ	
		{1576, 2958},--’∆µ∆π¨≈Æ	
		{1314, 3195},--…Ò√ÿÃ˙Ω≥	
		{1412, 3312},--Œ‰¡÷√À÷˜	
		{1442, 3061},--÷Ï«Æ◊Ø	
		{1478, 3237},--ƒ⁄∏Û…– È	
		{1312, 2848},--…Ò√ÿ…Ã»À
		{1657, 3261},--’∆µ∆π¨≈Æ
		{1577, 2957},--’∆µ∆π¨≈Æ
		{1439, 3267},--’∆µ∆π¨≈Æ
		{1385, 2977},--’∆µ∆π¨≈Æ
	},
	
	--∞Õ¡Íœÿ
	[53]={
		{1626, 3172},--“∞€≈	
		{1629, 3195},--¿ÒπŸ	
		{1598, 3209},--“©µÍ	
		{1600, 3170},--‘”ªı	
		{1578, 3236},--≥µ∑Ú	
	},
	
	--Ω≠–¬¥Â
	[20]={
		{3538, 6231},--“∞€≈	
		{3552, 6192},--¿ÒπŸ	
		{3469, 6164},--“©µÍ	
		{3370, 6256},--‘”ªı	
		{3458, 6110},--≥µ∑Ú	
		{3522, 6117},--‘¬¿œ	
	},
	
	--”¿¿÷
	[99]={
		{1646, 3192},--“∞€≈	
		{1614, 3177},--¿ÒπŸ	
		{1595, 3227},--“©µÍ	
		{1606, 3282},--‘”ªı	
		{1630, 3304},--≥µ∑Ú	
		{1607, 3161},--	
	},
	
	--÷Ïœ…’Ú
	[100]={
		{1616, 3199},--“∞€≈	
		{1621, 3181},--¿ÒπŸ	
		{1657, 3124},--“©µÍ	
		{1641, 3126},--‘”ªı	
		{1610, 3097},--≥µ∑Ú	
		{1678, 3101},--≥µ∑Ú	
		{1719, 3217},--≥µ∑Ú	
		{1603, 3168},--≥µ∑Ú	
	},
	
	--µæœ„¥Â
	[101]={
		{1677, 3143},--“∞€≈	
		{1671, 3172},--¿ÒπŸ	
		{1679, 3196},--“©µÍ	
		{1639, 3144},--‘”ªı	
		{1623, 3098},--≥µ∑Ú	
	},
	
	--¡˙√≈’Ú
	[121]={
		{1959, 4500},--“∞€≈	
		{1958, 4517},--¿ÒπŸ	
		{1934, 4551},--“©µÍ	
		{1914, 4524},--‘”ªı	
		{1924, 4527},--≥µ∑Ú	
		{1980, 4593},--≥µ∑Ú
	},
	
	-- Øπƒ’Ú
	[123]={
		{1643, 3235},--“∞€≈	
		{1606, 3227},--¿ÒπŸ	
		{1600, 3209},--“©µÍ	
		{1630, 3231},--‘”ªı	
		{1658, 3244},--≥µ∑Ú	
	},
	
	--¡˙»™¥Â
	[174]={
		{1608, 3200},--“∞€≈	
		{1631, 3215},--¿ÒπŸ	
		{1572, 3253},--“©µÍ	
		{1566, 3202},--‘”ªı	
		{1634, 3196},--≥µ∑Ú	
	},
--	-- ¡Ÿ∞≤
--	[176]={
--		{1695, 3294},
--		{1373, 3333},
--		{1353, 3018},
--		{1602, 2912},
--		{1687, 3319},
--		{1476, 3363},
--		{1545, 2966},
--		{1615, 2976},
--		{1340, 3166},
--		{1505, 2982},
--	},
--
--	-- „Íæ©
--	[37]={
--		{1704, 3222},
--		{1632, 3185},
--		{1595, 2995},
--		{1862, 2927},
--		{1785, 3104},
--		{1773, 3091},
--		{1806, 3097},
--	},
--
--	-- ≥…∂º
--	[11]={
--		{3196, 5193},
--		{3018, 5089},
--		{3029, 4958},
--		{3261, 5004},
--		{3095, 5135},
--		{3141, 5134},
--		{3126, 4993},
--	},
--
--	-- ¥Û¿Ì
--	[162]={
--		{1667, 3126},
--		{1468, 3271},
--		{1697, 3277},
--		{1535, 3202},
--		{1500, 3213},
--		{1586, 3221}
--	},
--	
--	-- œÂ—Ù
--	[78]={
--		{1596, 3379},
--		{1439, 3214},
--		{1511, 3142},
--		{1689, 3236},
--		{1628, 3263},
--		{1612, 3245},
--		{1539, 3248},
--	},	
--
--	-- ∑ÔœË
--	[1]={
--		{1651, 3279},
--		{1520, 3228},
--		{1557, 3108},
--		{1647, 3167},
--		{1559, 3206},
--		{1603, 3191},
--		{1614, 3151},
--	},	
--
--	-- —Ô÷›
--	[80]={
--		{1718, 3201},
--		{1593, 3197},
--		{1669, 2990},
--		{1824, 3064},
--		{1691, 3169},
--		{1702, 3022},
--		{1743, 2995},
--	},	
--	
--	-- Nam ‘¿’Ú
--	[54]={
--		{1590, 3092},
--		{1639, 3142},
--		{1648, 3108},
--	},
--		
--	-- ¡˙»™¥Â
--	[174]={
--		{1635, 3198},
--		{1594, 3228},
--		{1572, 3254},
--		{1631, 3216},
--	},
--	
--	-- Ω≠ΩÚ¥Â
--	[20]={
--		{3459, 6113},
--		{3468, 6163},
--		{3370, 6255},
--		{3552, 6192},
--	},
--
--	-- ¡˙√≈’Ú
--	[121]={
--		{1925, 4427},
--		{1980, 4595},
--		{1914, 4524},
--		{1934, 4551},
--		{1957, 4518},
--	},
--
--	--  Øπƒ’Ú
--	[153]={
--		{1631, 3179},
--		{1684, 3244},
--		{1600, 3209},
--		{1634, 3223},
--		{1606, 3228},
--	},
--	
--	-- µæœ„¥Â
--	[101]={
--		{1622, 3099},
--		{1679, 3196},
--		{1639, 3144},
--		{1671, 3173},
--	},
--	
--	-- ”¿¿÷’Ú
--	[99]={
--		{1608, 3163},
--		{1630, 3305},
--		{1595, 3227},
--		{1606, 3282},
--		{1614, 3177},
--	},
--	
--	-- ÷Ïœ…’Ú
--	[100]={
--		{1603, 3170},
--		{1611, 3099},
--		{1679, 3102},
--		{1720, 3217},
--		{1641, 3126},
--		{1657, 3124},
--		{1621, 3181},
--	},
--	
--	-- ∞Õ¡Íœÿ
--	[53]={
--		{1579, 3236},
--		{1598, 3209},
--		{1600, 3170},
--		{1629, 3195},
--	},
}


-- ºÏ≤‚ÕÊº“ «∑Ò‘⁄œﬁ÷∆«¯”Úƒ⁄
function offlineCheckPermitRegion()
	local nMapId, nX, nY = GetWorldPos();
	local nLimitX, nLimitY = 0,0;
	local szDirection, nDistance = "", 0;
	local i=0;
	if aryLimitRegion[nMapId] then
		for i=1, getn(aryLimitRegion[nMapId]) do
			nLimitX = aryLimitRegion[nMapId][i][1];
			nLimitY = aryLimitRegion[nMapId][i][2];
			szDirection, nDistance = getDirection({nX, nY}, {nLimitX, nLimitY});
			-- »Áπ˚æ‡¿Î»Œ∫Œ“ªµ„–°”⁄ 10£¨‘ÚÀµ√˜‘⁄Ω˚÷π«¯”Úƒ⁄
			if nDistance<=NUM_OFFLINE_PERMITREGION_MAX then
				return 0;
			end;
		end;
		return 1;
	else
		return 1;
	end;
end;


function StallCheckPermitRegion()
	if offlineCheckPermitRegion() == 1 then
		return 1
	else
		Talk(1, "", "Kh´ng th” bµy b∏n tπi khu v˘c nµy")
	end
end

-- ªÒµ√“ª∏ˆŒª÷√œ‡∂‘”⁄ÕÊº“Œª÷√µƒ¥ÛÃÂ∑ΩŒª
function getDirection(posOrigin, posTarget)
	
	local tbStr = {"T©y nam ", "Nam ", "ß´ng Nam ", "ß´ng ", "ß´ng Bæc ", "Bæc ", "T©y Bæc ", "T©y "};

	
	local nX	= posOrigin[2] - posTarget[2];
	local nY	= posTarget[1] - posOrigin[1];
	
	local nDeg	= atan2(posOrigin[2] - posTarget[2], posTarget[1] - posOrigin[1]);
	local nDirection = floor(nDeg/45+4.5);
	
	if (nDirection == 0) then
		nDirection = 8;
	end;
	
	-- æﬂÃÂµƒæ‡¿Î£¨»°’˚ ˝
	local nDistance = floor(sqrt(nX*nX + nY*nY));
	
	return tbStr[nDirection], nDistance;
	
end;
